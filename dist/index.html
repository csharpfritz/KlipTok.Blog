<html><head><title>Latest News and Notes About KlipTok from the Official KlipTok Blog</title><base href=./><link rel=stylesheet type=text/css href=site.css><link rel=stylesheet type=text/css href=prism.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-371VNCMVCF"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[];gtag("js",new Date);gtag("config","G-371VNCMVCF")</script></head><body><header><div class=container><a href=./><img src=kliptok.png alt="KlipTok Logo"></a><div><h1><a href=./>KlipTok News and Notes</a></h1><h3>All the latest updates about the KlipTok application</h3></div></div></header><main><div id=sidebar><h2>Links</h2><ul><li><a href=https://kliptok.com>KlipTok</a><li><a href=https://feedback.kliptok.com>KlipTok Feedback</a><li><a href=https://github.com/csharpfritz/KlipTok.Blog>Blog source on GitHub</a><li><a href=https://github.com/csharpfritz/KlipTok.Translations>Translation Repository</a></ul><h2>KlipTok uses:</h2><ul><li><a href=https://www.telerik.com/blazor-ui>Telerik UI for Blazor</a><li><a href=https://assemblyai.com>Assembly AI transcription services</a><li><a href=https://ravendb.net>RavenDb database</a><li><a href=https://github.com/csharpfritz/Fritz.StaticWeb>Fritz Static Web Generator</a></ul><a href="https://twitter.com/thekliptok?ref_src=twsrc%5Etfw" class=twitter-follow-button data-show-count=false>Follow @thekliptok</a><script async src=https://platform.twitter.com/widgets.js charset=utf-8></script></div><div id=main><div id=content><h2><a href=posts/4-Introducing_Playlists.html>Updates, 11 Million Clips, and Introducing Playlists</a></h2><p>It's been a long while since we've published an update about KlipTok, and there's a lot to document that's happened since. More clips, more features, architecture changes and cool new features we're planning.<p>Let's first talk about growth. KlipTok indexes a LOT of clips<h2 id=million-clips>11 Million clips!</h2><p><img src=img/11million.png alt="Line graph showing 11 million clips indexed"><p>We've crossed more than 11 million clips that have been indexed on the site. This is a jump of 9 million clips since May 2021, an 550% increase in data over that time. We're thrilled to see the growth in content, and want to encourage more folks to try KlipTok. There's a great catalog of channels, clips, and transcriptions for you to explore.<p>For those that are interested, this accounts for about 50GB of database storage.<h2 id=latest-feature-playlists>Latest Feature - Playlists</h2><p>Among the cool and unique features on KlipTok, you can now login with your Twitch account and create Playlists of clips from any channel. By grouping together these clips, you can share your playlists for others to view or to collect special memories almost like a "photo album".<p>Each user has their own collection of playlists, available from their streamer page or from the menu hiding under your profile picture.<p><img src=img/1-playlists.png alt="Fritz's Playlists"><p>Unlike other Twitch clips, these clips pay back to back to back with no advertising or pausing between videos. It's a non-stop video of Twitch shenanigans!<p><img src=img/2-playlist.png alt="Fritz's Fun Clips playlist, featuring a NASA clip"><p>You can get started creating and adding clips to a playlist just by logging in and clicking the + at the bottom-right of any clip you'd like to add to a playlist.<p><img src=img/3-AddToPlaylist.png alt="Fritz loses in Connect 4 and the new 'Add Playlist' button on the bottom right with a context menu to select a playlist to add to"><p>If you want to change the order of clips on your playlists, or remove clips from the playlist, you can click the edit button on the Playlists page or the playlist itself.<p><img src=img/4-EditPlaylist.png alt="Edit Playlists page"><p>You can then share your playlists with the 'Share button' at the top of the playlist page, right next to the 'Edit' button.<p>Have fun with playlists, they're a great way to group together some of your favorite videos and share with your friends.<h2 id=search-improvements>Search Improvements</h2><p>KlipTok's search feature keeps getting better. With this update, you can now filter search results by channels you follow or don't follow or even a specified list of channels you want to search, as well as filtering based on a Twitch category.<p><img src=img/5-SearchImprovements.png alt="New KlipTok Search Results page"><p>KlipTok's <em><strong>EXCLUSIVE</strong></em> search across transcriptions of clips continues to grow. We're adding new channels to the transcription feature and hope to see this continue to improve with our partner <a href=https://assemblyai.com>AssemblyAI</a><h2 id=streamer-dashboard-improvements>Streamer Dashboard Improvements</h2><p>Have you wondered when the most clips are being generated for your channel? Who are the folks creating the most watched clips?<p>We've added some updates to the streamer dashboard on your streamer page, just click the 'Dashboard' link at the top (or button at the bottom of your mobile web browser) and you can see the clips created over the last 90 days, a heat map of when the clips were created, and more details about who is creating clips.<p>All of these entries in the bar charts, heat map, and lists or clippers and categories are all clickable so that you can search for JUST those clips.<p><img src=img/6-Dashboard.png alt="Improved Streamer Dashboard"><h2 id=live-channels-and-sidebar-refresh>Live Channels and Sidebar Refresh</h2><p>We've added 'now live' indicators to the KlipTok sidebar as well as a block of up to 4 channels that recently went live, regardless of whether those 4 channels have clips. In this way, you can see which of the channels you enjoy are live and how long they've been live.<p>We're continuing to show the links to the channels you follow that had the most recent clips created, in the lower third of the sidebar.<p><img src=img/7-sidebar.png alt="Snippet of Fritz's sidebar showing some streamers that are currently live."><p>If other streamers in the Suggested and Followed channels sections are live as well, they will also display a similar 'live indicator'. All of the live indicators can be clicked to jump right to that channel on Twitch.<p>The sidebar now updates every 2 minutes, refreshing the list of Suggested Streamers and updating the 'Recently Live Streamers' section with up to date information about who recently went live.<p>We've also added some menus on the sidebar as kabob menus that allow you to jump to that channel's dashboard, the clips that streamer has created, or to mute the channel.<p><img src=img/8-sidebar-contextmenu.png alt="The new sidebar context menu"><h2 id=database-updates>Database Updates</h2><p>In August 2021, we started a long process to update the KlipTok database to <a href=https://ravendb.net>RavenDb</a>. RavenDb gives KlipTok a NoSQL style storage engine, complete with full-text search and adaptive indexes. RavenDb is such a smart database that when it sees things are running slow it builds a new index to make things FASTER.<p><img src=img/10-RavenDbCluster.png alt="RavenDb Cluster Topology in May 2022"><p>We're currently running KlipTok on RavenDb Cloud in an Azure datacenter on 3 nodes for redundancy.<p>We'll publish more details about the migration to RavenDb in the weeks ahead.<h2 id=twitch-integrated-panel>Twitch Integrated Panel</h2><p>You can now add KlipTok to your Twitch channel! We built and deployed an extension to Twitch that shows the clips created by day of week and the folks from your Twitch community that have created the most viewed clips on your channel.<p><img src=img/9-KlipTokDock.png alt="KlipTok Dock extension on Twitch"><p>Look for the <a href=https://dashboard.twitch.tv/extensions/eakutjhdwh3m1p7vd7uodnvweuhzmz-0.2.0>KlipTokDock extension on Twitch</a> to add this panel to your channel.<h2 id=summary>Summary</h2><p>We've added a LOT of features to KlipTok over the last few months and have not spent as much time promoting and sharing those features on this blog. We're going to get back to that and share more in the months ahead.<p>We're about to start work on a discovery algorithm to help recommend new clips and streamers on Twitch that we think you'll enjoy. This algorithm will be built with ML.NET, Azure Functions, and RavenDb.<p>Take a look at <a href=https://kliptok.com>KlipTok</a> and explore some of the great Twitch clips that we have indexed for you.<h2><a href=posts/4-FourMillionChannels.html>Milestone Reached - 4 MILLION Clips Indexed!</a></h2><p>KlipTok just crossed another major milestone on the evening of August 18th:<div class=center><p><img src=img/4million.PNG alt="4 million clips on the KlipTok dashboard"></div><p>We're now service more than 4 million klips for about 750 Twitch channels with more than 11k transcriptions. It's a huge step, and is stored on about 10GB of storage for the database and search indexes.<h2 id=how-are-those-4-million-clips-stored-and-indexed>How are those 4 million clips stored and indexed?</h2><p>The clips are stored in a MySql database hosted on Microsoft Azure that allows us to join in and query based on the channel id or the unique 'slug' text that identifies the clip.<p>There are entries in <a href=https://azure.microsoft.com/services/storage/tables/>Azure Table Storage</a> for the titles of the clips and the transcriptions of the clips. This table storage is further indexed by <a href=https://azure.microsoft.com/services/search/>Azure Cognitive Search</a> so that you can search for clips based on the title of the clip or the words spoken in the clip.<p>I use <a href=https://azure.microsoft.com/services/service-bus/>Azure Service Bus</a> to process all of these records as they arrive from Twitch, get processed by AssemblyAI for transcripts, and store the clip data for processing and search indexing.<p>That's... that's a lot of storage to manage and indexes to update. What if we could make that a lot more concise and simpler?<h2 id=enter-ravendb>Enter RavenDb</h2><p>Starting next week, we're going to start migrating data to RavenDb. <a href=https://ravendb.net>RavenDb</a> is a NoSQL database provider that has a bunch of smart features built into it that allow it to detect and build indexes appropriately for our queries. It also has a built in search indexing feature that allows us to generate a search index and search fields in document records.<p>Additionally, I have found and witnessed a few demos that show how to build an elementary recommendation engine using RavenDb queries. When I saw these demos, I was sold on being able to build and roll out a better list of recommended channels and clips to discover on the front page of KlipTok.<p>RavenDb feels like a perfect match for the various ways that we store and interact with clip data for KlipTok. I hope you tune in to the <a href=https://twitch.tv/csharpfritz>csharpfritz Twitch stream</a> in the week ahead as I migrate and roll out this update.<h2><a href=posts/3-IntroducingCategoriesAndContentSafety.html>Version 0.23 - Introducing IAB Categories and Content Safety</a></h2><p>This week we are happy to announce the release of Version 0.23 with a number of small fixes, updated translations, a new translation for Slovenian, and a new feature: IAB Categories and Content Safety tags for transcribed clips. I'm definitely burying the lede here, but I think it's worth it to give you a quick summary of what's new.<h2 id=iab-categories-and-content-safety>IAB Categories and Content Safety</h2><p>With our partners at <a href=https://assemblyai.com>Assembly AI</a>, we've introduced IAB Categories and Content Safety tags to clips. You'll recall that we added clip transcriptions to KlipTok in July and made those transcriptions available to search. We're the only website on the internet where you can search for videos based on the dialogue in the video.<div class=center><p><img src=img/transcription_search.png alt="Search for 'Thanks Amanda' and finding the clip"><p><span aria-label=caption class=caption>Search for 'Thanks Amanda' and finding the clip where I say "Thanks Amanda"</span></div><p>The <a href=https://www.iab.com>Interactive Advertising Bureau (IAB)</a> has a set of categories that you can use to categorize your videos. They're a great way to make sure that your videos are appropriate for children and young people. A <a href=https://www.iab.com/guidelines/video-ad-categories/>full list of categories</a> is available online. We've added the categories to KlipTok and you can see them tagged on clips that have been transcribed.<div class=center><p><img src=img/IabAndSafetyTags.PNG alt="IAB Category Tags and Content Safety Tags for a clip"><p><span aria-label=caption class=caption>IAB Category Tags and Content Safety Tags for a clip</span></div><p>AssemblyAI provides a feature to <a href=https://docs.assemblyai.com/guides/iab-categorization>detect the IAB Categories</a> of your videos based on their transcript. These categories can be VERY accurate... and sometimes a little funny in what they are guessing your clips are about. KlipTok is only going to show the first 4 categories with more than 60% confidence that it thinks your video falls into. There's a hidden tooltip on each of the tags showing the confidence percentage reported by AssemblyAI's detection algorithm for that category on the clip.<h3 id=content-safety-tags>Content Safety tags</h3><p>The second AssemblyAI detection feature we are implementing is the <a href=https://docs.assemblyai.com/guides/content-safety-detection>detection of content safety</a> warnings. This feature uses the same transcription analysis and detection request to detect foul language and other topics that may require content safety warnings in various cultures. These tags are added with a red background to separate them from the category tags. Just like the IAB category tags, you can inspect the hidden tooltip on each tag to see the confidence percentage reported by AssemblyAI for each tag.<h2 id=translation-updates>Translation Updates</h2><p>Translations for KlipTok (to date) have been created and maintained by the user community. We saw a few updates over the last week for Farsi, Finnish, German, Indonesian, Italian, and Polish translations. Additionally, Slovenian was added to our roster of 23 languages supported by KlipTok.<p>Finally, we have updated the translation combobox to list each supported language in their native language to make it easier to locate and translate KlipTok to your preferred written language.<div class=center><p><img src=img/translation_box.PNG alt="Native translations of the languages in the language selector"><p><span aria-label=caption class=caption>Native translations of the languages in the language selector</span></div><h3 id=how-does-kliptok-translate-to-your-language>How does KlipTok translate to your language?</h3><p>KlipTok uses a library called <a href=https://github.com/jsakamoto/Toolbelt.Blazor.I18nText>Toolbelt.Blazor.I18nText</a> to translate its text. There is an object embedded in every Blazor component delivered on KlipTok called <code>Localize</code> that loads up the correct translation file for your language.<pre><code class=language-csharp>	if (Localize == null)
	{
		Localize = await I18nText.GetTextTableAsync<i18ntext.kliptok>(this);
		StateHasChanged();
	}</i18ntext.kliptok></code></pre><p>All text that is rendered for the web page passes through that collection. The Search bar at the top of the screen has it's watermark text placed with:<pre><code class=language-csharp>@Localize?["SearchKlipTok"]</code></pre><p>The search results text referencing the <code>SearchTerm</code> submitted is formatted like this:<pre><code class=language-csharp><p>@string.Format(Localize?["SearchedKlipTokAndFoundTemplate"], SearchTerm)</code></pre><p>The translations are all stored in JSON format and open for community contributions <a href=https://github.com/csharpfritz/KlipTok.Translations>on GitHub</a><h2 id=up-next>Up Next</h2><p>KlipTok has grown and become a bit more complex over the last few months. We're service more than 3.8 million clips and need to provide some assurance that updates to the site don't break things. I've started working on building integration tests using <a href=https://playwright.dev>Playwright</a> and will be making those test scripts publicly available <a href=https://github.com/csharpfritz/KlipTok.IntegrationTests>on GitHub</a> as well.<h2 id=summary>Summary</h2><p>Introducing these new features and translations has added a lot of value to KlipTok and made it easier for your to understand the content you'll find in the clips we present. I hope you find these new features useful as I move forward with additional improvements.<h2><a href=posts/2-IntroducingLiveIndicators.html>Most Requested Feature Deployed - Live Now on Twitch</a></h2><p>Over the last few months, the most requested feature on KlipTok on the <a href=https://feedback.kliptok.com>feedback site</a> has been the addition of a "Live Now" indicator for the list of channels.<div class=center><p><a href=https://feedback.kliptok.com/posts/23/live-now-icon-next-to-the-channels-name-in-the-list-of-streamers><img src=img/feedback-LiveIndicator.png alt="Screenshot from feedback.kliptok.com - Request to add a 'Live' indicator next to channels"></a><p><span aria-label=caption class=caption>Original feedback requesting the Live Indicator</span></div><p>On Twitch, its a simple red circle.. the circle doesn't really tell you anything, and you need to hover over it in order to see what it actually means. On KlipTok, we want to be more inclusive and support folks that have different web usage capabilities.<p>Our 'Live Now' indicator is a red rounded square with the word 'LIVE' in the middle. It's easy to spot and clear what it's referring to. If you click on it, you'll be taken to their channel in a new tab of your browser.<p>You can even use the sidebar refresh buttons, the spinning arrows next to the titles in the sidebar, to refresh the list of current channels that KlipTok has for you and it will update the Live status appropriately as well.<div class=center><p><img src=img/liveIndicator.png alt="Screenshot of KlipTok showing the new LIVE indicator in the sidebar"><p><span aria-label=caption class=caption>Implementation of the Live Indicator on KlipTok</span></div><h2 id=behind-the-feature-how-does-it-work>Behind the feature - How does it work?</h2><p>As more of KlipTok is built, we're going to use this as an opportunity to <strong>TEACH</strong> more about how to build websites and the features behind them. Going forward, look for descriptions about the KlipTok architecture, but not all of our secrets, whenever a new feature is released.<h3 id=getting-the-live-status-from-twitch>Getting the Live Status from Twitch</h3><p>The <a href=https://dev.twitch.tv/docs/api/reference#get-streams>Twitch APIs</a> make it easy to run a query to collect the current state of a stream.<pre><code>GET https://api.twitch.tv/helix/streams?user_id=96909659&amp;user_id=63208102
</code></pre><p>This query would return data similar to the following:<pre><code>{
  "data": [
    {
      "id": "41375541868",
      "user_id": "96909659",
      "user_login": "csharpfritz",
      "user_name": "csharpfritz",
      "game_id": "509670",
      "game_name": "Science &amp; Technology",
      "type": "live",
      "title": "Writing software",
      "viewer_count": 78,
      "started_at": "2021-03-10T15:04:21Z",
      "language": "es",
      "thumbnail_url": "https://static-cdn.jtvnw.net/previews-ttv/live_user_auronplay-{width}x{height}.jpg",
      "tag_ids": [
        ""
      ],
      "is_mature": false
    },
    ...
  ],
  "pagination": {
    "cursor": "abcdef1234"
  }
}
</code></pre><p>When KlipTok's background processes run to discover newly created clips, they inspect the list of currently active streams and ONLY search those streams for new clips. We know that more than 95% of the clips that are created for a stream are created while the broadcaster is actively streaming, so we focus on collecting those clips as they are created. Once an hour, we examine ALL channels that KlipTok has indexed.<p>Since we were collecting this data about the active streams in order to filter the list of channels that the KlipTok processes were searching against, why not save that information and present it to the KlipTok users as they use the site? Easy enough... we created a <code>LiveChannels</code> table and stored the id of the channels that are currently streaming.<p>I wrote a method on our <code>LiveChannelsRepository</code> class that would <code>Replace</code> the current contents of the table with the collection of the live channels we discovered. It's crude, but it works.<pre><code class=language-csharp>	await _LiveChannelsRepository.Replace(
		liveChannels.Select(l => new Twitch.TwitchStreamRecord
		{
			user_id = l.ChannelId,
			started_at = l.LiveSince
		})
	);</code></pre><p>When we assemble the sidebar for a user, we include the <code>LiveChannels</code> table in the query and present the Live Indicator when a record is present in the <code>LiveChannels</code> table for the channel in the sidebar.<h2 id=summary>Summary</h2><p>Adding this feature was a great re-use of existing data that KlipTok was already working with, and feels almost like re-using content with no additional cost to us. Stay tuned as we add new Search features, clip metadata, and launch the Top 5 Klips of the Week in August.<h2><a href=posts/1-WelcomeToKlipTok.html>Welcome to KlipTok!</a></h2><p>This is our first post on the KlipTok blog, and I'm thrilled to have this live for folks to learn more about how KlipTok is built and to allow us to announce new features as well as milestones reached. I'll have a few more posts today and later this week talking about what KlipTok is, how it was built, and how you can participate.<h2 id=how-it-started>How it started</h2><p>KlipTok has been built by a Twitch Streamer, for Twitch Streamers, LIVE on Twitch. It started in November 2020 as an idea to help make Twitch clips more discoverable with a UI that brought your favorite clips from the channels you follow. That 12-hour stream is archived and available:<div style=width:100%;text-align:center><iframe width=560 height=315 src="https://www.youtube.com/embed/6uMCAHEM8Es?start=310" title="YouTube video player" frameborder=0 allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div><p>The technical goal of this web application was to build a complete site using the <a href=https://blazor.net>Blazor web framework</a> with <a href=https://dot.net>C# and .NET 5</a> running completely on <a href=https://azure.microsoft.com>Microsoft Azure</a>. We use Azure Static Websites to make that happen along with a number of other Microsoft Azure services, and we'll cover more of that in an upcoming blog post.<h2 id=fast-forward-to-today>Fast Forward to Today</h2><p>At the time of the writing of this blog post (at the end of July 2021), we're about 8 months into the evolution of the site and it hosts about 680 channels clips. There are more than 3.1 million clips that KlipTok has indexed and are available for you to discover.<p>We've added the ability for the site to be translated to a number of different languages with the help of our KlipTok community. The translations are all available in JSON format <a href=https://github.com/csharpfritz/KlipTok.Translations>on GitHub</a> and you are welcome to contribute new or missing translations.<p>Viewer and user feedback is VERY important to me in the construction of KlipTok, and I've configured a user feedback website using <a href=https://getfider.com>Fider</a>. You can see the requested features and my notes about the next features that are going to be built at <a href=https://feedback.kliptok.com>https://feedback.kliptok.com</a><p>I'm writing a handful of posts to get things started here to describe some of the direction behind the site, the tenets we follow as development progresses, and the Azure-based architecture used.<p>I hope to separate the Blazor application into its own repository and release the UI as an open source project before the end of July 2021. In this way, you can learn from how the application was written and even contribute back some updates to improve the user-interface.<h2 id=one-more-thing>One more thing...</h2><p>I've added an amazing feature to KlipTok with the help of the folks at <a href=https://assemblyai.com>Assembly AI</a> to provide transcription for clips. This means you can search for clips based on what was SAID in the clip, not just the title of the clip. This is the ONLY video sharing service on the internet that provides this service, and we have much more planned with our friends at Assembly AI.<h2 id=summary>Summary</h2><p>So.. welcome to KlipTok! I'm looking forward to building much more for this web application and learning about how to use many more cloud services and taking advantage of the coolest new .NET technologies to grow it and make it an application you find useful.</div></div></main><footer>Copyright ©2021 KlipTok Inc.</footer><script src=prism.js></script></body></html>